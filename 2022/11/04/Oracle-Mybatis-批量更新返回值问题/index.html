<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#73B9FF"><meta name="author" content="Su"><meta name="copyright" content="Su"><meta name="generator" content="Hexo 6.3.0"><meta name="theme" content="hexo-theme-yun"><title>Oracle &amp; Mybatis æ‰¹é‡æ›´æ–°è¿”å›å€¼é—®é¢˜ | Su</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#73B9FF"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"674019130.github.io","root":"/","title":["é™ª","æˆ‘","å»","çœ‹","æµ·"],"version":"1.10.9","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"æœç´¢...","empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹: ${query}","hits":"æ‰¾åˆ° ${hits} æ¡ç»“æœ","hits_time":"æ‰¾åˆ° ${hits} æ¡ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]},"waline":{"config":{"enable":true,"serverURL":"https://vercel-waline-c111rx0gg-674019130.vercel.app/","comment":true,"visitor":true,"emoji":["https://fastly.jsdelivr.net/npm/@waline/emojis@latest/bilibili/","https://fastly.jsdelivr.net/npm/@waline/emojis@latest/weibo/","https://fastly.jsdelivr.net/npm/@waline/emojis@latest/qq/"],"locale":{"placeholder":"æ­å–œä½ å‘ç°äº†éšè—å†…å®¹~"},"requiredMeta":["nick"],"el":"#waline","lang":"zh-CN"},"cdn":"https://fastly.jsdelivr.net/npm/@waline/client@v2/dist/waline.js","dark":"html.dark"},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><link rel="preconnect" href="https://www.google-analytics.com" crossorigin><script async src="https://www.googletagmanager.com/gtag/js?id=G-HQ8BSZ6WTF"></script><script>if (CONFIG.hostname === location.hostname) {
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-HQ8BSZ6WTF');
}</script><meta name="description" content="Mybatis åœ¨ä½¿ç”¨ï¼ˆæ‰¹é‡ï¼‰æ›´æ–°è¯­å¥çš„æ—¶å€™ï¼Œåº”è¯¥åœ¨ SQL è¯­å¥æ­£å¸¸æ‰§è¡Œå®Œæ¯•åè¿”å›ã€Œå—å½±å“è¡Œæ•°ã€ï¼Œä½†åœ¨è¿æ¥çš„æ•°æ®åº“æ˜¯ Oracle çš„æ—¶å€™å´ä¸€ç›´è¿”å› -1ï¼Œæ— æ³•å¯¹ SQL çš„æ‰§è¡ŒçŠ¶æ€è¿›è¡Œåˆ¤æ–­ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘åšäº†ä¸€äº›å°è¯•â€¦â€¦">
<meta property="og:type" content="article">
<meta property="og:title" content="Oracle &amp; Mybatis æ‰¹é‡æ›´æ–°è¿”å›å€¼é—®é¢˜">
<meta property="og:url" content="https://674019130.github.io/2022/11/04/Oracle-Mybatis-%E6%89%B9%E9%87%8F%E6%9B%B4%E6%96%B0%E8%BF%94%E5%9B%9E%E5%80%BC%E9%97%AE%E9%A2%98/index.html">
<meta property="og:site_name" content="Su">
<meta property="og:description" content="Mybatis åœ¨ä½¿ç”¨ï¼ˆæ‰¹é‡ï¼‰æ›´æ–°è¯­å¥çš„æ—¶å€™ï¼Œåº”è¯¥åœ¨ SQL è¯­å¥æ­£å¸¸æ‰§è¡Œå®Œæ¯•åè¿”å›ã€Œå—å½±å“è¡Œæ•°ã€ï¼Œä½†åœ¨è¿æ¥çš„æ•°æ®åº“æ˜¯ Oracle çš„æ—¶å€™å´ä¸€ç›´è¿”å› -1ï¼Œæ— æ³•å¯¹ SQL çš„æ‰§è¡ŒçŠ¶æ€è¿›è¡Œåˆ¤æ–­ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘åšäº†ä¸€äº›å°è¯•â€¦â€¦">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tva3.sinaimg.cn/large/008kWByAly8h7swp3ep1wj30j80lp76t.jpg">
<meta property="article:published_time" content="2022-11-04T01:29:59.000Z">
<meta property="article:modified_time" content="2023-02-27T08:10:07.887Z">
<meta property="article:author" content="Su">
<meta property="article:tag" content="æ•°æ®åº“">
<meta property="article:tag" content="Oracle">
<meta property="article:tag" content="Mybatis">
<meta property="article:tag" content="Java">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tva3.sinaimg.cn/large/008kWByAly8h7swp3ep1wj30j80lp76t.jpg"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><canvas id="trianglifyContainer"></canvas><script defer src="https://fastly.jsdelivr.net/npm/trianglify@4/dist/trianglify.bundle.js"></script><script>document.addEventListener("DOMContentLoaded", () => {
  const pattern = trianglify({
    width: 800,
    height: 600,
    cellSize: 75,
    palette: ["YlGnBu", "GnBu", "Blues"],
  });
  const canvasOpts = {
    applyCssScaling: false
  }
  document.body.appendChild(pattern.toCanvas(trianglifyContainer, canvasOpts));
});</script><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="æ–‡ç« ç›®å½•"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="ç«™ç‚¹æ¦‚è§ˆ"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info mickey-mouse"><a class="site-author-avatar" href="/about/" title="Su"><img width="96" loading="lazy" src="/images/avatar.png" alt="Su"><span class="site-author-status" title="ä¸æƒ³ä¸Šç­">ğŸ’Œ</span></a><div class="site-author-name"><a href="/about/">Su</a></div><span class="site-name">Su</span><sub class="site-subtitle">Code and Life Notes.</sub><div class="site-description"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="é¦–é¡µ"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="å½’æ¡£"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">10</span></a></div><div class="site-state-item"><a href="/categories/" title="åˆ†ç±»"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">10</span></a></div><div class="site-state-item"><a href="/tags/" title="æ ‡ç­¾"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">13</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="æ–‡æ¡£"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:settings-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="/atom.xml" title="RSS" target="_blank" style="color:orange"><span class="icon iconify" data-icon="ri:rss-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/674019130" title="GitHub" target="_blank" style="color:#181717"><span class="icon iconify" data-icon="ri:github-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:ostarsbutmyeyes@gmail.com" title="E-Mail" target="_blank" style="color:#8E71C1"><span class="icon iconify" data-icon="ri:mail-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=247102977" title="ç½‘æ˜“äº‘éŸ³ä¹" target="_blank" style="color:#C10D0C"><span class="icon iconify" data-icon="ri:netease-cloud-music-line"></span></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="æˆ‘çš„å°ä¼™ä¼´ä»¬" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:genderless-line"></span></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9C%BA%E6%99%AF"><span class="toc-number">1.</span> <span class="toc-text">åœºæ™¯</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%97%AE%E9%A2%98"><span class="toc-number">2.</span> <span class="toc-text">é—®é¢˜</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-number">3.</span> <span class="toc-text">è§£å†³æ–¹æ¡ˆ</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%90%90%E6%A7%BD"><span class="toc-number">4.</span> <span class="toc-text">åæ§½</span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#73B9FF;"><link itemprop="mainEntityOfPage" href="https://674019130.github.io/2022/11/04/Oracle-Mybatis-%E6%89%B9%E9%87%8F%E6%9B%B4%E6%96%B0%E8%BF%94%E5%9B%9E%E5%80%BC%E9%97%AE%E9%A2%98/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="Su"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="Su"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Oracle &amp; Mybatis æ‰¹é‡æ›´æ–°è¿”å›å€¼é—®é¢˜</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="åˆ›å»ºæ—¶é—´ï¼š2022-11-04 09:29:59" itemprop="dateCreated datePublished" datetime="2022-11-04T09:29:59+08:00">2022-11-04</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-2-line"></span></span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2023-02-27 16:10:07" itemprop="dateModified" datetime="2023-02-27T16:10:07+08:00">2023-02-27</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="æœ¬æ–‡å­—æ•°"><span class="icon iconify" data-icon="ri:file-word-line"></span></span> <span title="æœ¬æ–‡å­—æ•°">1.3k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="é˜…è¯»æ—¶é•¿"><span class="icon iconify" data-icon="ri:timer-line"></span></span> <span title="é˜…è¯»æ—¶é•¿">5m</span></span></span><span class="post-busuanzi"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="é˜…è¯»æ¬¡æ•°"><span class="icon iconify" data-icon="ri:eye-line"></span> <span id="busuanzi_value_page_pv"></span></span></span><span class="leancloud_visitors" id="/2022/11/04/Oracle-Mybatis-%E6%89%B9%E9%87%8F%E6%9B%B4%E6%96%B0%E8%BF%94%E5%9B%9E%E5%80%BC%E9%97%AE%E9%A2%98/" data-flag-title="Oracle &amp; Mybatis æ‰¹é‡æ›´æ–°è¿”å›å€¼é—®é¢˜"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="é˜…è¯»æ¬¡æ•°"><span class="icon iconify" data-icon="ri:eye-line"></span> <span class="leancloud-visitors-count"></span></span></span><span class="post-meta-divider">-</span><a href="#comment"><span class="post-meta-item-icon" title="è¯„è®ºæ•°"><span class="icon iconify" data-icon="ri:chat-3-line"></span> <span class="waline-comment-count" id="/2022/11/04/Oracle-Mybatis-%E6%89%B9%E9%87%8F%E6%9B%B4%E6%96%B0%E8%BF%94%E5%9B%9E%E5%80%BC%E9%97%AE%E9%A2%98/"></span></span></a><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/%E5%A5%87%E5%A5%87%E6%80%AA%E6%80%AA%E7%9A%84%E9%A1%B9%E7%9B%AE%E9%87%8C%E7%9A%84%E9%97%AE%E9%A2%98/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">å¥‡å¥‡æ€ªæ€ªçš„é¡¹ç›®é‡Œçš„é—®é¢˜</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">æ•°æ®åº“</span></a><a class="tag-item" href="/tags/Oracle/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">Oracle</span></a><a class="tag-item" href="/tags/Mybatis/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">Mybatis</span></a><a class="tag-item" href="/tags/Java/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">Java</span></a></span></div><div class="post-author"><span class="author-name">è‹</span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><h1 id="åœºæ™¯"><a href="#åœºæ™¯" class="headerlink" title="åœºæ™¯"></a>åœºæ™¯</h1><p>ORMï¼šMybatis</p>
<p>æ•°æ®åº“ï¼šOracle</p>
<p>ç»„é‡Œæ–°äººå†™çš„ä¸€ä¸ªæ¥å£ã€‚</p>
<p>ä¼ ç»™ Mapper å±‚çš„æ˜¯ä¸¤ä¸ªå…ƒç´ æ•°é‡ç›¸ç­‰çš„ Listï¼Œæ ¹æ®æŸä¸¤ä¸ªå­—æ®µæ˜¯å¦ä¸ List ä¸­çš„å…ƒç´ åŒ¹é…ï¼Œå¯¹ status å­—æ®µåšæ›´æ–°ã€‚</p>
<h1 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h1><p>å‡å¦‚ä¼ å…¥ 3 æ¡æ•°æ®ï¼Œå¯¹åº”æ•°æ®åº“ä¸­ï¼Œåº”è¯¥æ›´æ–°ä¸‰è¡Œçš„ statusï¼Œå¦‚æœèƒ½å¤Ÿåšåˆ°å…¨éƒ¨æ›´æ–°æˆåŠŸï¼Œåˆ™ç»§ç»­åç»­ä¸šåŠ¡çš„æ‰§è¡Œã€‚ä½†æ˜¯æ— è®ºå—å½±å“è¡Œæ•°æ˜¯ 0 æˆ–å…¶ä»–ä»»ä½•éè´Ÿæ•´æ•°ï¼Œæ–¹æ³•çš„è¿”å›å€¼éƒ½æ˜¯ -1ã€‚æ— æ³•è·å–å—å½±å“è¡Œæ•°ã€‚</p>
<h1 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h1><p>è¿™ä¸ªé¡¹ç›®ç”¨çš„æ˜¯ xml æ–‡ä»¶å†™ mapperï¼Œä¸ºäº†å®ç°æ‰¹é‡æŸ¥è¯¢ï¼Œéœ€è¦åœ¨ <code>foreach</code> æ ‡ç­¾é‡Œæ·»åŠ ä¸€äº›ä¸œè¥¿ã€‚</p>
<p><code>   &lt;foreach collection=&quot;list&quot; item=&quot;item&quot; index=&quot;index&quot; open=&quot;begin&quot; close=&quot;;end;&quot; separator=&quot;;&quot;&gt;</code></p>
<p>è§£å†³äº†æ‰¹é‡æ›´æ–°çš„é—®é¢˜ï¼Œè¿”å›å€¼è¿˜æ˜¯ -1ï¼Œå¼€å§‹æŸ¥ç½‘ä¸Šçš„èµ„æ–™ã€‚æ— å¥ˆ Mybatis &amp; Oracle çš„ç›¸å…³èµ„æ–™éå¸¸å°‘ï¼ŒåŒ…æ‹¬å¤–ç½‘ä¹Ÿæ˜¯ã€‚</p>
<p>å½“æ•°æ®åº“æ˜¯ MySQL çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹ JDBC çš„ URL å‚æ•°ï¼Œæ·»åŠ <code>â€affectedRows=trueâ€œ</code>æ¥å®ç°è¿”å›å—å½±å“è¡Œæ•°çš„åŠŸèƒ½ï¼ˆæˆ‘è‡ªå·±åœ¨ MySQL æ•°æ®åº“å¼€å‘çš„æ—¶å€™å¹¶æ²¡æœ‰é‡åˆ°éœ€è¦é¢å¤–é…ç½®è¿™ä¸ªå‚æ•°çš„æƒ…å†µï¼‰ã€‚äºæ˜¯æˆ‘å»æœäº† Oracle JDBC çš„å®˜æ–¹æ–‡æ¡£ï¼Œå®˜æ–¹ç»™å‡ºçš„ URL å‚æ•°é‡Œå¹¶æ²¡æœ‰æ•ˆæœç±»ä¼¼<code>â€affectedRowsâ€œ</code>çš„ï¼Œè¿™æ¡è·¯èµ°ä¸é€šã€‚</p>
<p>JDBC è¿æ¥ä¸Šèµ°ä¸é€šï¼Œçœ‹çœ‹èƒ½ä¸èƒ½ä» Mybatis å…¥æ‰‹ã€‚ç»§ç»­æœåˆ«çš„èµ„æ–™ã€‚</p>
<p>æœåˆ°æœ‰è§£é‡Šè¯´ï¼Œè¿”å›å€¼æ˜¯ -1 æ˜¯ç”±äºï¼š</p>
<blockquote>
<p>æ˜¯ç”±äºdefaultExecutorTypeçš„å¼•èµ·çš„ï¼ŒdefaultExecutorTypeæœ‰ä¸‰ä¸ªæ‰§è¡Œå™¨SIMPLEã€REUSEå’ŒBATCHã€‚å…¶ä¸­BATCHå¯ä»¥æ‰¹é‡æ›´æ–°æ“ä½œç¼“å­˜SQLä»¥æé«˜æ€§èƒ½ï¼Œä½†æ˜¯æœ‰ä¸ªç¼ºé™·å°±æ˜¯æ— æ³•è·å–updateã€deleteè¿”å›çš„è¡Œæ•°ã€‚defaultExecutorTypeçš„é»˜è®¤æ‰§è¡Œå™¨æ˜¯SIMPLEã€‚</p>
<table>
<thead>
<tr>
<th>åç§°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>SIMPLE</td>
<td>æ‰§è¡Œå™¨æ‰§è¡Œå…¶å®ƒè¯­å¥</td>
</tr>
<tr>
<td>REUSE</td>
<td>å¯èƒ½é‡å¤ä½¿ç”¨prepared statements è¯­å¥</td>
</tr>
<tr>
<td>BATCH</td>
<td>å¯ä»¥é‡å¤æ‰§è¡Œè¯­å¥å’Œæ‰¹é‡æ›´æ–°</td>
</tr>
</tbody></table>
<p>ç”±äºé¡¹ç›®é…ç½®ä¸­å¯ç”¨äº†BATCHæ‰§è¡Œå™¨ï¼ŒUPDATEå’ŒDELETEè¿”å›çš„è¡Œæ•°å°±ä¸¢å¤±äº†ï¼ŒæŠŠæ‰§è¡Œå™¨æ”¹ä¸ºSIMPLEå³å¯ã€‚</p>
</blockquote>
<p>ä½†æ˜¯è¯¥é¡¹ç›®çš„ Mybatis é…ç½®æ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mybatis:</span></span><br><span class="line">    <span class="attr">configuration:</span></span><br><span class="line">        <span class="attr">default-executor-type:</span> <span class="string">simple</span></span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥è¿™æ¡è·¯ä¹Ÿèµ°ä¸é€šï¼Œç»§ç»­æ‰¾åŸå› ã€‚</p>
<p>åœ¨ StackOverflow æ‰¾åˆ°æœ‰ä¸ªäººè¯´ç”¨ BEGIN + END + ; å®ç°çš„å¹¶ä¸æ˜¯ ã€Œa batch operationã€ï¼Œè¿™é‡Œå¼•å‡ºäº† statement batch çš„ç±»å‹ã€‚</p>
<blockquote>
<p><img src="https://tva3.sinaimg.cn/large/008kWByAly8h7swp3ep1wj30j80lp76t.jpg" alt="image-20221104103007804" loading="lazy"></p>
</blockquote>
<p>ä½†æ˜¯å®é™…æµ‹è¯•çš„æ—¶å€™å‘ç°<code>getUpdateCounts()</code>è¿”å›çš„æ•°ç»„è¿˜æ˜¯éƒ½æ˜¯ -2ã€‚</p>
<p>æ— å¥ˆå·²ç»ä¸‹ç­ä¸€ä¸ªå°æ—¶äº†ï¼Œåªå¥½å…ˆç”¨ <code>in</code>ä»£æ›¿äº†<code>where</code>æ¡ä»¶ä¸­çš„<code>=</code>ï¼ŒæŠ›å¼ƒäº†æ‰¹é‡æ›´æ–°ï¼Œä¿®æ”¹ä¸ºäº†ä¸€æ¡ SQL è¯­å¥ã€‚è¿™æ ·å¯ä»¥æ­£å¸¸è·å–è¿”å›å€¼ã€‚</p>
<p>ç¬¬äºŒå¤©æ—©ä¸Šæ¥äº†å°±åœ¨æŸ¥è¿˜æœ‰æ²¡æœ‰ç›¸å…³çš„èµ„æ–™ã€‚æŸ¥åˆ°ä¸€ä¸ªäººè¯»äº†æ›´å¤šçš„ Oracle JDBC çš„æ–‡æ¡£ï¼Œè§£å†³äº†æˆ‘çš„é—®é¢˜ã€‚</p>
<blockquote>
<p>åæ¥ï¼Œåœ¨ Oracle çš„æ–‡æ¡£è¯´æ˜ä¸­ï¼Œå‘ç°çš„åŸå› ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://docs.oracle.com/cd/E11882_01/java.112/e16548/oraperf.htm#JJDBC28777">https://docs.oracle.com/cd/E11882_01/java.112/e16548/oraperf.htm#JJDBC28777</a></p>
<p>å…¶ä¸­ï¼Œæœ‰ä¸€æ®µè¯´æ˜ï¼š</p>
<p>Update Counts in the Oracle Implementation of Standard Batching</p>
<p>If a statement batch is processed successfully, then the integer array, or update counts array, returned by the statement <code>executeBatch</code> call will always have one element for each operation in the batch. In the Oracle implementation of standard update batching, the values of the array elements are as follows:</p>
<ul>
<li>For a prepared statement batch, it is not possible to know the number of rows affected in the database by each individual statement in the batch. Therefore, all array elements have a value of <code>-2</code>. According to the JDBC 2.0 specification, a value of <code>-2</code> indicates that the operation was successful but the number of rows affected is unknown.</li>
<li>For a generic statement batch, the array contains the actual update counts indicating the number of rows affected by each operation. The actual update counts can be provided only in the case of generic statements in the Oracle implementation of standard batching.</li>
<li>For a callable statement batch, the server always returns the value <code>1</code> as the update count, irrespective of the number rows affected by each operation.</li>
</ul>
<p>In your code, upon successful processing of a batch, you should be prepared to handle either <code>-2</code>, <code>1</code>, or true update counts in the array elements. For a successful batch processing, the array contains either all <code>-2</code>, 1, or all positive integers.</p>
</blockquote>
<p>é’ˆå¯¹ä¸‰ç§ä¸åŒçš„ã€Œstatement batchã€ï¼ŒOracle ç»™å‡ºçš„è¿”å›å€¼æ˜¯ä¸åŒçš„ï¼Œä¹Ÿä»£è¡¨äº†ä¸åŒçš„æ„ä¹‰ï¼Œæ–‡æ¡£é‡Œè¯´çš„å¾ˆæ˜ç™½ã€‚</p>
<ul>
<li><p>parpared statementï¼š-2 è¡¨ç¤ºæ‰§è¡ŒæˆåŠŸï¼Œä½†æ— æ³•è¿”å›å®é™…æˆåŠŸè¡Œæ•°ï¼›</p>
</li>
<li><p>generic statementï¼šè¿”å›å®é™…æˆåŠŸè¡Œæ•°ï¼›</p>
</li>
<li><p>callable statementï¼šæ°¸è¿œè¿”å› 1ï¼›</p>
</li>
</ul>
<p>æœ€ç»ˆçš„è§£å†³æ–¹æ¡ˆï¼ŒæŠ›å¼ƒ Mybatisï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="type">int</span> <span class="title function_">updateList</span><span class="params">(List &lt; MyObject &gt; myList)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> myList.size();</span><br><span class="line">    <span class="type">int</span> <span class="variable">batchSize</span> <span class="operator">=</span> <span class="number">100</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">Long</span> <span class="variable">affectedRows</span> <span class="operator">=</span> <span class="number">0</span> L;</span><br><span class="line"></span><br><span class="line">    <span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> sqlSessionFactory.openSession(ExecutorType.BATCH);</span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> sqlSession.getConnection();</span><br><span class="line">    <span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        statement = conn.createStatement();</span><br><span class="line">        conn.setAutoCommit(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (MyObject obj: myList) &#123;</span><br><span class="line">            index++;</span><br><span class="line"></span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update tb_test set status = &quot;</span> + obj.getStatus + <span class="string">&quot; where id = &quot;</span> + obj.getId();</span><br><span class="line">            statement.addBatch(sql);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (index % batchSize == <span class="number">0</span> || index == size) &#123;</span><br><span class="line">                <span class="type">int</span>[] ints = statement.executeBatch();</span><br><span class="line">                affectedRows += IntStream.of(ints).sum();</span><br><span class="line">                statement.clearBatch();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        conn.commit();</span><br><span class="line">        conn.setAutoCommit(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException throwables) &#123;</span><br><span class="line">        throwables.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (statement != <span class="literal">null</span> &amp;&amp; !statement.isClosed()) &#123;</span><br><span class="line">                statement.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException throwables) &#123;</span><br><span class="line">            throwables.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (conn != <span class="literal">null</span> &amp;&amp; !conn.isClosed()) &#123;</span><br><span class="line">                conn.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException throwables) &#123;</span><br><span class="line">            throwables.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> affectedRows.intValue();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="åæ§½"><a href="#åæ§½" class="headerlink" title="åæ§½"></a>åæ§½</h1><ul>
<li><p>Oracle ç»™æˆ‘ä¸€ç§å¾ˆéš¾ç”¨çš„æ„Ÿè§‰ã€‚</p>
</li>
<li><p>ç½‘ç»œä¸Šï¼ˆå°¤å…¶æ˜¯ CSDN &amp; åšå®¢å›­ï¼‰çš„èµ„æ–™åŸºæœ¬éƒ½æ˜¯å¤åˆ¶æ¥å¤åˆ¶å»ï¼Œæ¯«æ— è¥å…»ã€‚</p>
</li>
<li><p>æ–°äººæ‰‹é‡Œé‚£ä¸ªé¡¹ç›®çš„ä»£ç è´¨é‡ä¸€è¨€éš¾å°½ï¼Œä¸»è¦æ˜¯æ³¨é‡Šå’Œé­”æ³•æ•°é—®é¢˜ã€‚</p>
</li>
<li><p>ä¸‰ç§ statement çš„åŒºåˆ†æ˜¯ä»€ä¹ˆï¼Œåé¢æ‰¾æœºä¼šå†äº†è§£ä¸‹ã€‚ï¼ˆæ‡’ç‹—ä¸€æ¡ğŸ¶</p>
</li>
</ul>
</div></section><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="æ‰“èµ" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><span class="icon iconify" data-icon="ri:hand-coin-line"></span></span><div id="reward-comment">I'm so cute. Please give me money.</div><div id="qr" style="display:none;"><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.yunyoujun.cn/img/donate/alipay-qrcode.jpg"><img loading="lazy" src="https://cdn.yunyoujun.cn/img/donate/alipay-qrcode.jpg" alt="æ”¯ä»˜å®" title="æ”¯ä»˜å®"></a><div><span style="color:#00A3EE"><span class="icon iconify" data-icon="ri:alipay-line"></span></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.yunyoujun.cn/img/donate/qqpay-qrcode.png"><img loading="lazy" src="https://cdn.yunyoujun.cn/img/donate/qqpay-qrcode.png" alt="QQ æ”¯ä»˜" title="QQ æ”¯ä»˜"></a><div><span style="color:#12B7F5"><span class="icon iconify" data-icon="ri:qq-line"></span></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.yunyoujun.cn/img/donate/wechatpay-qrcode.jpg"><img loading="lazy" src="https://cdn.yunyoujun.cn/img/donate/wechatpay-qrcode.jpg" alt="å¾®ä¿¡æ”¯ä»˜" title="å¾®ä¿¡æ”¯ä»˜"></a><div><span style="color:#2DC100"><span class="icon iconify" data-icon="ri:wechat-pay-line"></span></span></div></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>æœ¬æ–‡ä½œè€…ï¼š</strong>è‹</li><li class="post-copyright-link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="https://674019130.github.io/2022/11/04/Oracle-Mybatis-%E6%89%B9%E9%87%8F%E6%9B%B4%E6%96%B0%E8%BF%94%E5%9B%9E%E5%80%BC%E9%97%AE%E9%A2%98/" title="Oracle &amp; Mybatis æ‰¹é‡æ›´æ–°è¿”å›å€¼é—®é¢˜">https://674019130.github.io/2022/11/04/Oracle-Mybatis-%E6%89%B9%E9%87%8F%E6%9B%B4%E6%96%B0%E8%BF%94%E5%9B%9E%E5%80%BC%E9%97%AE%E9%A2%98/</a></li><li class="post-copyright-license"><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é»˜è®¤é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><span class="icon iconify" data-icon="ri:creative-commons-line"></span><span class="icon iconify" data-icon="ri:creative-commons-by-line"></span><span class="icon iconify" data-icon="ri:creative-commons-nc-line"></span><span class="icon iconify" data-icon="ri:creative-commons-sa-line"></span></a> è®¸å¯åè®®ã€‚</li></ul></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2023/01/05/%E5%85%B3%E4%BA%8E%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83%E7%9A%84%E4%B8%80%E4%BA%9B%E7%B2%97%E6%B5%85%E6%83%B3%E6%B3%95/" rel="prev" title="å…³äºä»£ç è§„èŒƒçš„ä¸€äº›ç²—æµ…æƒ³æ³•"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">å…³äºä»£ç è§„èŒƒçš„ä¸€äº›ç²—æµ…æƒ³æ³•</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2022/11/02/LeetCode-SQL-notes/" rel="next" title="LeetCode æ•°æ®åº“åˆ·é¢˜ç¬”è®°"><span class="post-nav-text">LeetCode æ•°æ®åº“åˆ·é¢˜ç¬”è®°</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>è‹¥æ‚¨æƒ³åŠæ—¶å¾—åˆ°å›å¤æé†’ï¼Œå»ºè®®è·³è½¬ GitHub Issues è¯„è®ºã€‚</span><br><span>è‹¥æ²¡æœ‰æœ¬æ–‡ Issueï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ Comment æ¨¡ç‰ˆæ–°å»ºã€‚</span><br><span></span><br><span>ğŸ˜Šä»¥ä¸‹è¯„è®ºç³»ç»Ÿå‡éœ€ç§‘å­¦ä¸Šç½‘ï¼Œä½œä¸º GitHub ç”¨æˆ·ï¼Œæœ‰ç†ç”±ç›¸ä¿¡æ‚¨å·²ç»æŒæ¡äº†è¯¥æŠ€èƒ½ã€‚</span><br><span>ğŸ‘è‹¥æ‚¨æ—  GitHub è´¦å·ï¼Œæ¨èä½¿ç”¨ waline ä½œä¸ºè¯„è®ºç³»ç»Ÿï¼Œå¡«å†™é‚®ç®±å¯ä»¥æ”¶åˆ°å›å¤é€šçŸ¥~</span><br><a class="hty-button hty-button--raised" id="github-issues" target="_blank" rel="noopener" href="https://github.com/674019130/674019130.github.io/issues?q=is:issue+Oracle &amp; Mybatis æ‰¹é‡æ›´æ–°è¿”å›å€¼é—®é¢˜">GitHub Issues</a></div><div class="toggle-comment-system" style="margin: 1rem auto"><a class="toggle-comment-btn hty-button hty-button--raised text-uppercase" data-target="#waline" onclick="showComment(this.dataset.target)">waline</a><style>.utterances {
  display: none;
}</style><a class="toggle-comment-btn hty-button hty-button--raised text-uppercase" data-target=".utterances" onclick="showComment(this.dataset.target)">utterances</a><script>function hideAllComment() {
  //- hide all
  document.querySelectorAll('.toggle-comment-btn').forEach((btn) => {
    const container = document.querySelector(btn.dataset.target);
    if (container) {
      container.style.display = "none";
    }
  });
}
function showComment(target) {
  hideAllComment();
  //- show target
  const targetContainer = document.querySelector(target);
  if (targetContainer) {
    targetContainer.style.display = "block";
  }
}
</script></div><div id="waline"></div><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@waline/client@v2/dist/waline.css"><script>window.CONFIG.waline.config.path = "/2022/11/04/Oracle-Mybatis-%E6%89%B9%E9%87%8F%E6%9B%B4%E6%96%B0%E8%BF%94%E5%9B%9E%E5%80%BC%E9%97%AE%E9%A2%98/"</script><div class="js-Pjax"><script src="/js/comments/waline.js" type="module" defer></script></div><style>.utterances {
  max-width: 100%;
}</style><script src="https://utteranc.es/client.js" repo="674019130/674019130.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async></script></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2019 â€“ 2023 </span><span class="with-love" id="animate"><span class="icon iconify" data-icon="ri:cloud-line"></span></span><span class="author"> Su</span></div><div class="powered"><span>ç”± <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> é©±åŠ¨ v6.3.0</span><span class="footer-separator">|</span><span>ä¸»é¢˜ - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.10.9</span></div><div class="live-time"><span>é£å·²ç»èµ°äº†</span><span id="display_live_time"></span><span class="moe-text">(â—'â—¡'â—)</span><script>function blog_live_time() {
  setTimeout(blog_live_time, 1000);
  const start = new Date('2022-10-31T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = ` ${passDay} å¤© ${passHour} å°æ—¶ ${passMinute} åˆ† ${passSecond} ç§’`;
}
blog_live_time();
</script></div><div id="busuanzi"><span id="busuanzi_container_site_uv" title="æ€»è®¿å®¢é‡"><span><span class="icon iconify" data-icon="ri:user-line"></span></span><span id="busuanzi_value_site_uv"></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv" title="æ€»è®¿é—®é‡"><span><span class="icon iconify" data-icon="ri:eye-line"></span></span><span id="busuanzi_value_site_pv"></span></span><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#73B9FF" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" target="_blank" rel="noopener" href="https://www.google.com/search?q=site:674019130.github.io" title="æœç´¢"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:search-line"></span></span></a><script>function initMourn() {
  const date = new Date();
  const today = (date.getMonth() + 1) + "-" + date.getDate()
  const mourn_days = ["4-4","9-18"]
  if (mourn_days.includes(today)) {
    document.documentElement.style.filter = "grayscale(1)";
  }
}
initMourn();</script><script src="https://fastly.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script><script>const images = [...document.querySelectorAll('.markdown-body img')]
mediumZoom(images)</script><style>.medium-zoom-image {
  z-index: 99;
}</style></body></html>